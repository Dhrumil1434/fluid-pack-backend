{
  "package_analysis": {
    "exceljs": {
      "version": "^4.4.0",
      "status": "installed",
      "use_cases": [
        "Excel export for all table data with pagination support",
        "Support for images embedded in Excel cells",
        "Rich formatting (colors, fonts, borders, cell merging)",
        "Multiple worksheets support for complex data",
        "Cell formulas and data validation",
        "Hyperlinks for document links",
        "Column width auto-sizing",
        "Freeze panes for headers",
        "Conditional formatting for status badges"
      ],
      "benefits_for_fluid_pack": [
        "Export all displayed records (not just current page) with proper formatting",
        "Embed machine images directly in Excel cells",
        "Create clickable document links in Excel",
        "Maintain table structure with proper column headers",
        "Support for metadata fields and nested data structures",
        "Export filtered/search results with all applied filters",
        "Beautiful styling matching admin dashboard theme"
      ],
      "implementation_notes": [
        "Use Workbook and Worksheet classes for structure",
        "Add images using addImage() method with proper positioning",
        "Use hyperlinks for document file_path URLs",
        "Apply styles using style property (font, fill, border, alignment)",
        "Handle pagination by fetching all records matching current filters",
        "Create separate worksheets for different data types if needed"
      ]
    },
    "pdfkit": {
      "version": "^0.17.2",
      "status": "installed",
      "use_cases": [
        "Low-level PDF generation with precise control",
        "Custom layouts and positioning",
        "Image embedding and manipulation",
        "Text wrapping and formatting",
        "Vector graphics and shapes",
        "Multi-page documents with headers/footers"
      ],
      "benefits_for_fluid_pack": [
        "Full control over PDF layout and design",
        "Embed images with proper sizing and positioning",
        "Create beautiful individual record PDFs",
        "Custom headers and footers with company branding",
        "Support for complex layouts (multi-column, tables)",
        "Watermark support for confidential documents"
      ],
      "implementation_notes": [
        "Use PDFDocument for creating PDFs",
        "Embed images using embedImage() or embedPng()",
        "Use text() and moveDown() for text layout",
        "Create tables manually using text positioning",
        "Add page numbers and metadata",
        "Support for fonts and custom typography"
      ]
    },
    "html-to-pdfmake": {
      "version": "^2.5.32",
      "status": "installed",
      "use_cases": [
        "Convert HTML/CSS to pdfmake document definition",
        "Preserve HTML structure and styling",
        "Support for tables, lists, and formatted text",
        "CSS class mapping to pdfmake styles"
      ],
      "benefits_for_fluid_pack": [
        "Reuse existing HTML templates for PDF generation",
        "Convert Angular component templates to PDF",
        "Maintain consistent styling between web and PDF",
        "Easier maintenance with HTML-based templates"
      ],
      "implementation_notes": [
        "Convert HTML strings to pdfmake document definition",
        "Map CSS classes to pdfmake style definitions",
        "Handle images and links in HTML",
        "Use with pdfmake for final PDF generation"
      ]
    },
    "pdfmake": {
      "version": "^0.2.20",
      "status": "installed",
      "use_cases": [
        "High-level PDF generation with declarative API",
        "Rich text formatting and styling",
        "Tables with automatic layout",
        "Images, vectors, and QR codes",
        "Multi-page documents",
        "Client and server-side generation"
      ],
      "benefits_for_fluid_pack": [
        "Easy to use declarative API for PDF creation",
        "Beautiful table layouts with automatic sizing",
        "Rich formatting (colors, fonts, borders, alignment)",
        "Support for images and document links",
        "Consistent styling across all PDF exports",
        "Better than pdfkit for complex table layouts"
      ],
      "implementation_notes": [
        "Use docDefinition object to define PDF structure",
        "Define styles object for reusable styling",
        "Use tables property for tabular data",
        "Embed images using images object with base64 or URLs",
        "Use columns and stack for layout",
        "Support for custom fonts if needed",
        "Generate PDF using createPdf() method"
      ]
    }
  },
  "recommended_approach": {
    "excel_export": {
      "primary_package": "exceljs",
      "reason": "Best for Excel exports with image support and rich formatting",
      "use_for": [
        "Bulk data exports (all records matching filters)",
        "Data with images (machines, QC entries)",
        "Complex nested data structures",
        "Multiple related datasets"
      ]
    },
    "pdf_export_individual": {
      "primary_package": "pdfmake",
      "secondary_package": "html-to-pdfmake",
      "reason": "Easier API for complex layouts, better table support than pdfkit",
      "use_for": [
        "Individual record detail PDFs",
        "Beautiful formatted reports",
        "Documents with images and tables",
        "Consistent styling across all PDFs"
      ],
      "alternative": {
        "package": "pdfkit",
        "use_when": "Need pixel-perfect control or custom graphics"
      }
    },
    "workflow": [
      "1. User clicks 'Export to Excel' button on any table page",
      "2. Backend fetches ALL records matching current filters (not just current page)",
      "3. Use exceljs to create workbook with proper formatting",
      "4. Embed images in Excel cells where applicable",
      "5. Add hyperlinks for document file_paths",
      "6. Apply styling matching admin dashboard theme",
      "7. Return Excel file as download",
      "8. For individual PDF: Use pdfmake to create beautiful formatted PDF",
      "9. Include all record data, images, and documents",
      "10. Apply consistent branding and styling"
    ]
  },
  "styling_guidelines": {
    "excel_styles": {
      "header": {
        "font": { "bold": true, "size": 12, "color": { "argb": "FFFFFFFF" } },
        "fill": { "type": "pattern", "pattern": "solid", "fgColor": { "argb": "FF3B82F6" } },
        "alignment": { "horizontal": "center", "vertical": "middle" },
        "border": {
          "top": { "style": "thin", "color": { "argb": "FF000000" } },
          "bottom": { "style": "thin", "color": { "argb": "FF000000" } },
          "left": { "style": "thin", "color": { "argb": "FF000000" } },
          "right": { "style": "thin", "color": { "argb": "FF000000" } }
        }
      },
      "data_row": {
        "font": { "size": 11 },
        "alignment": { "vertical": "middle" },
        "border": {
          "bottom": { "style": "thin", "color": { "argb": "FFE5E7EB" } }
        }
      },
      "status_approved": {
        "fill": { "type": "pattern", "pattern": "solid", "fgColor": { "argb": "FF10B981" } },
        "font": { "color": { "argb": "FFFFFFFF" }, "bold": true }
      },
      "status_pending": {
        "fill": { "type": "pattern", "pattern": "solid", "fgColor": { "argb": "FFF59E0B" } },
        "font": { "color": { "argb": "FFFFFFFF" }, "bold": true }
      },
      "status_rejected": {
        "fill": { "type": "pattern", "pattern": "solid", "fgColor": { "argb": "FFEF4444" } },
        "font": { "color": { "argb": "FFFFFFFF" }, "bold": true }
      }
    },
    "pdf_styles": {
      "header": {
        "fontSize": 24,
        "bold": true,
        "color": "#1E40AF",
        "margin": [0, 0, 0, 20]
      },
      "subheader": {
        "fontSize": 16,
        "bold": true,
        "color": "#374151",
        "margin": [0, 10, 0, 10]
      },
      "label": {
        "fontSize": 11,
        "bold": true,
        "color": "#6B7280",
        "margin": [0, 5, 0, 2]
      },
      "value": {
        "fontSize": 12,
        "color": "#111827",
        "margin": [0, 0, 0, 10]
      },
      "table_header": {
        "bold": true,
        "fontSize": 11,
        "color": "#FFFFFF",
        "fillColor": "#3B82F6",
        "alignment": "center"
      },
      "table_cell": {
        "fontSize": 10,
        "color": "#111827"
      },
      "status_approved": {
        "color": "#FFFFFF",
        "fillColor": "#10B981",
        "bold": true
      },
      "status_pending": {
        "color": "#FFFFFF",
        "fillColor": "#F59E0B",
        "bold": true
      },
      "status_rejected": {
        "color": "#FFFFFF",
        "fillColor": "#EF4444",
        "bold": true
      }
    },
    "color_scheme": {
      "primary": "#3B82F6",
      "success": "#10B981",
      "warning": "#F59E0B",
      "danger": "#EF4444",
      "background": "#F9FAFB",
      "text_primary": "#111827",
      "text_secondary": "#6B7280",
      "border": "#E5E7EB"
    }
  },
  "image_handling": {
    "excel": {
      "method": "exceljs addImage()",
      "sizing": {
        "width": 100,
        "height": 100,
        "unit": "pixels"
      },
      "positioning": "Embed in specific cells or create image column",
      "formats_supported": ["png", "jpeg", "jpg", "gif"],
      "notes": "Images are embedded directly in Excel file"
    },
    "pdf": {
      "method": "pdfmake images object with base64 or file paths",
      "sizing": {
        "width": 200,
        "height": 200,
        "fit": [200, 200]
      },
      "positioning": "Inline with text or in dedicated sections",
      "formats_supported": ["png", "jpeg", "jpg"],
      "notes": "Convert images to base64 or use file system paths"
    }
  },
  "document_link_handling": {
    "excel": {
      "method": "Hyperlink in cell",
      "format": "Clickable link showing document name",
      "implementation": "Use cell.value = { text: 'Document Name', hyperlink: 'file:///path' }"
    },
    "pdf": {
      "method": "Link annotation",
      "format": "Clickable text link",
      "implementation": "Use link property in text definition"
    }
  }
}

